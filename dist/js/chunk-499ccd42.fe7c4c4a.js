(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-499ccd42"],{"3fbf":function(e,o,t){"use strict";t("b122")},"98cf":function(e,o,t){"use strict";t.r(o);var s,i=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中"}},[t("div",{staticClass:"handle-box"},[t("div",{staticClass:"btn"},[t("el-button",{attrs:{type:"primary"},on:{click:e.addGoods}},[e._v("添加商品")])],1),t("div",{staticClass:"btn"},[t("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入商品名称"},nativeOn:{keyup:function(o){return!o.type.indexOf("key")&&e._k(o.keyCode,"enter",13,o.key,"Enter")?null:e.search(e.keyword)}},model:{value:e.keyword,callback:function(o){e.keyword=o},expression:"keyword"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(o){return e.search(e.keyword)}},slot:"append"})],1)],1)]),t("el-dialog",{attrs:{visible:e.dialogGood,title:e.isAdd?"添加商品":"编辑",center:"",width:"1200px"},on:{"update:visible":function(o){e.dialogGood=o},close:e.close}},[t("el-form",{attrs:{"label-width":"150px",model:e.goodsInfo}},[t("el-form-item",{attrs:{label:"是否上架"}},[t("el-radio-group",{model:{value:e.goodsInfo.on_shelf,callback:function(o){e.$set(e.goodsInfo,"on_shelf",o)},expression:"goodsInfo.on_shelf"}},[t("el-radio",{attrs:{label:1}},[e._v("是")]),t("el-radio",{attrs:{label:2}},[e._v("否")])],1)],1),t("el-form-item",{attrs:{label:"是否允许到店自取"}},[t("el-radio-group",{attrs:{disabled:e.isDisabled},on:{change:e.changeFetch},model:{value:e.goodsInfo.is_fetch,callback:function(o){e.$set(e.goodsInfo,"is_fetch",o)},expression:"goodsInfo.is_fetch"}},[t("el-radio",{attrs:{label:1}},[e._v("是")]),t("el-radio",{attrs:{label:2}},[e._v("否")])],1)],1),1==e.goodsInfo.is_fetch?t("el-form-item",{attrs:{label:"可以到店自取的部门"}},[t("el-select",{staticStyle:{width:"400px"},attrs:{multiple:"",placeholder:"请选择部门(可多选)"},on:{change:e.merchantChange},model:{value:e.goodsInfo.have_merchant,callback:function(o){e.$set(e.goodsInfo,"have_merchant",o)},expression:"goodsInfo.have_merchant"}},e._l(e.merchantList,(function(e,o){return t("el-option",{key:o,attrs:{label:e.name,value:e.id}})})),1),t("span",{staticClass:"chose-btn"},[t("el-button",{attrs:{type:"text"},on:{click:e.allSel}},[e._v("全选部门")])],1)],1):e._e(),t("el-form-item",{attrs:{label:"商品名称"}},[t("el-input",{model:{value:e.goodsInfo.name,callback:function(o){e.$set(e.goodsInfo,"name",o)},expression:"goodsInfo.name"}})],1),t("el-form-item",{attrs:{label:"商品简介"}},[t("el-input",{model:{value:e.goodsInfo.intro,callback:function(o){e.$set(e.goodsInfo,"intro",o)},expression:"goodsInfo.intro"}})],1),t("div",{staticClass:"momey-info"},[t("el-form-item",{attrs:{label:"市级佣金"}},[t("el-input",{attrs:{placeholder:"请输入佣金(市级)"},model:{value:e.goodsInfo.good_commissions[0].money,callback:function(o){e.$set(e.goodsInfo.good_commissions[0],"money",o)},expression:"goodsInfo.good_commissions[0].money"}})],1),t("el-form-item",{attrs:{label:"区县佣金"}},[t("el-input",{attrs:{placeholder:"请输入佣金(区县)"},model:{value:e.goodsInfo.good_commissions[1].money,callback:function(o){e.$set(e.goodsInfo.good_commissions[1],"money",o)},expression:"goodsInfo.good_commissions[1].money"}})],1),t("el-form-item",{attrs:{label:"社区佣金"}},[t("el-input",{attrs:{placeholder:"请输入佣金(社区)"},model:{value:e.goodsInfo.good_commissions[2].money,callback:function(o){e.$set(e.goodsInfo.good_commissions[2],"money",o)},expression:"goodsInfo.good_commissions[2].money"}})],1)],1),t("div",{staticClass:"momey-info"},[t("el-form-item",{attrs:{label:"价格"}},[t("el-input",{model:{value:e.goodsInfo.price,callback:function(o){e.$set(e.goodsInfo,"price",o)},expression:"goodsInfo.price"}})],1),t("el-form-item",{attrs:{label:"运费"}},[t("el-input",{model:{value:e.goodsInfo.freight,callback:function(o){e.$set(e.goodsInfo,"freight",o)},expression:"goodsInfo.freight"}})],1)],1),t("div",{staticClass:"momey-info"},[t("el-form-item",{attrs:{label:"商品销量"}},[t("el-input",{model:{value:e.goodsInfo.sales,callback:function(o){e.$set(e.goodsInfo,"sales",o)},expression:"goodsInfo.sales"}})],1),t("el-form-item",{attrs:{label:"浏览量"}},[t("el-input",{model:{value:e.goodsInfo.browse,callback:function(o){e.$set(e.goodsInfo,"browse",o)},expression:"goodsInfo.browse"}})],1)],1),t("el-form-item",{attrs:{label:"商品图片"}},[t("el-upload",{ref:"upload",attrs:{action:"https://api.fengniaotuangou.cn/api/upload",limit:1,"before-upload":e.beforeAvatarUpload,"on-success":e.handleAvatarSuccess,"on-remove":e.handleRemove,"file-list":e.files,"on-exceed":e.handleExceed,"list-type":"picture-card","on-change":e.handleChange,"auto-upload":!0}},[t("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),t("el-form-item",{attrs:{label:"批量上传详情图片"}},[t("el-upload",{ref:"upload",attrs:{action:"https://api.fengniaotuangou.cn/api/upload",limit:9,"before-upload":e.beforeAvatarUpload1,"on-remove":e.handleRemove1,"on-exceed":e.handleExceed1,"auto-upload":!0,"on-change":e.handleChange1,multiple:"","list-type":"picture-card","file-list":e.fileLists,"on-success":e.handleAvatarSuccess1}},[t("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),t("el-form-item",{attrs:{label:"商品详情"}},[t("quill-editor",{ref:"myQuillEditor",staticStyle:{height:"430px",margin:"0 0 60px 0"},attrs:{options:e.editorOption},model:{value:e.goodsInfo.detail,callback:function(o){e.$set(e.goodsInfo,"detail",o)},expression:"goodsInfo.detail"}}),t("el-upload",{staticClass:"avatar-uploader quill-img",staticStyle:{display:"none"},attrs:{action:"https://api.fengniaotuangou.cn/api/upload","before-upload":e.beforeUpload,"on-success":e.quillImgSuccess}},[t("el-button",{attrs:{size:"small",type:"primary",id:"imgInput","element-loading-text":"插入中,请稍候"}},[e._v("点击上传 ")])],1)],1),t("div",{staticClass:"submit"},[t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.newMerchants}},[e._v("提交")])],1)],1)],1)],1),t("el-table",{attrs:{data:e.tableData,"empty-text":"暂无数据",border:"","header-cell-style":{background:"#f0f0f0"},"max-height":"620"}},[t("el-table-column",{attrs:{prop:"id",label:"ID"}}),t("el-table-column",{attrs:{prop:"name",label:"名称"}}),t("el-table-column",{attrs:{prop:"img",label:"图片",width:"150"},scopedSlots:e._u([{key:"default",fn:function(o){return[o.row.img?t("div",[t("el-popover",{attrs:{placement:"top-start",title:"",trigger:"click"}},[t("img",{staticStyle:{"max-width":"800px","max-height":"800px"},attrs:{src:o.row.img}}),t("img",{staticStyle:{"max-width":"180px","max-height":"80px"},attrs:{slot:"reference",src:o.row.img},slot:"reference"})])],1):t("div",[t("span",[e._v("--暂无图片--")])])]}}])}),t("el-table-column",{attrs:{prop:"price",label:"价格"}}),t("el-table-column",{attrs:{prop:"freight",label:"运费"}}),t("el-table-column",{attrs:{prop:"is_fetch",label:"是否到店自取",width:"120"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-switch",{attrs:{"active-color":"#2a9f93"},on:{change:function(t){return e.notifyChange(o.row.is_fetch,o.$index,o.row)}},model:{value:o.row.is_fetch,callback:function(t){e.$set(o.row,"is_fetch",t)},expression:"scope.row.is_fetch"}})]}}])}),t("el-table-column",{attrs:{prop:"on_shelf",label:"是否上架"},scopedSlots:e._u([{key:"default",fn:function(o){return[1==o.row.on_shelf?t("div",[t("span",[e._v("是")])]):e._e(),2==o.row.on_shelf?t("div",[t("span",[e._v("否")])]):e._e()]}}])}),t("el-table-column",{attrs:{prop:"sales",label:"销量"}}),t("el-table-column",{attrs:{prop:"browse",label:"浏览量"}}),t("el-table-column",{attrs:{prop:"created_at",label:"创建时间",width:"180"}}),t("el-table-column",{attrs:{label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleDetail(o.$index,o.row)}}},[e._v("编辑")]),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.handleDelete(o.$index,o.row)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"block"},[t("el-pagination",{attrs:{"current-page":e.current,"page-sizes":[10,20,30,40,50],"page-size":e.size,layout:"sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.currentChange,"update:currentPage":function(o){e.current=o},"update:current-page":function(o){e.current=o},"size-change":e.sizeChange}})],1),t("el-dialog",{attrs:{visible:e.dialogSel,title:"可到店自取部门",width:"85%"},on:{"update:visible":function(o){e.dialogSel=o},close:e.close}},[t("el-form",{attrs:{"label-width":"150px",model:e.goodsInfo}},[t("el-form-item",{attrs:{label:"可以到店自取的部门"}},[t("el-select",{staticStyle:{width:"400px"},attrs:{multiple:"",placeholder:"请选择部门(可多选)"},on:{change:e.merchantChange},model:{value:e.goodsInfo.have_merchant,callback:function(o){e.$set(e.goodsInfo,"have_merchant",o)},expression:"goodsInfo.have_merchant"}},e._l(e.merchantList,(function(e,o){return t("el-option",{key:o,attrs:{label:e.name,value:e.id}})})),1),t("span",{staticClass:"chose-btn"},[t("el-button",{attrs:{type:"text"},on:{click:e.allSel}},[e._v("全选部门")])],1)],1),t("el-form-item",{attrs:{label:"运费"}},[t("el-input",{model:{value:e.goodsInfo.freight,callback:function(o){e.$set(e.goodsInfo,"freight",o)},expression:"goodsInfo.freight"}})],1),t("div",{staticClass:"submit"},[t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.newMerchants}},[e._v("提交")])],1)],1)],1)],1),t("el-dialog",{attrs:{visible:e.dialogDel,title:"删除商品",width:"20%",align:"center","close-on-click-modal":!1},on:{"update:visible":function(o){e.dialogDel=o}}},[t("div",{staticStyle:{"font-size":"20px","margin-bottom":"30px"}},[e._v("是否删除")]),t("span",[t("el-button",{attrs:{type:"primary"},on:{click:e.toDel}},[e._v("删除")]),t("el-button",{attrs:{type:"danger"},on:{click:function(o){e.dialogDel=!1}}},[e._v("取消")])],1)])],1)},n=[],l=(t("4160"),t("caad"),t("c975"),t("d81d"),t("a434"),t("b0c0"),t("ac1f"),t("2532"),t("1276"),t("159b"),t("365c")),a=(t("3022"),t("8d81"),t("953d")),r=(t("a753"),t("8096"),t("14e1"),{inject:["reload"],components:{quillEditor:a["quillEditor"]},data:function(){return{loading:!0,tableData:[],current:1,size:10,total:0,id:"",dialogDel:!1,dialogGood:!1,editorOption:{placeholder:"请输入文档内容",theme:"snow",modules:{toolbar:{container:[["bold","italic","underline","strike"],["blockquote","code-block"],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image"]],handlers:{image:function(e){e?document.querySelector(".quill-img input").click():this.quill.format("image",!1)}}}}},goodsInfo:{name:"",intro:"",detail:"",img:"",imgs:[],price:"",freight:"",on_shelf:1,is_fetch:1,have_merchant:[],sales:0,browse:0,sort:0,good_commissions:[{type:1,money:""},{type:2,money:""},{type:3,money:""}]},merchantList:[],name:"",stateList:[{value:1,label:"是"},{value:2,label:"否"}],state:"",keyword:"",fileLists:[],files:[],permissionData:[],is_fetch:!0,dialogSel:!1,isDisabled:!1,isAdd:!1}},mounted:function(){this.getList(this.current,this.size),this.getParent(),this.permissionData=localStorage.getItem("permissions").split(",")},methods:{getParent:function(){var e=this;l["a"].merchantsSelect().then((function(o){e.merchantList=o.result}))},getList:function(e,o,t,s){var i=this;l["a"].userGoods(e,o,t,s).then((function(e){i.loading=!1,i.tableData=e.result.data,i.total=e.result.total,e.result.data.forEach((function(e){1==e.is_fetch?e.is_fetch=!0:e.is_fetch=!1}))})).catch((function(e){i.loading=!1}))},search:function(){var e=this;e.current=1,e.loading=!0,e.getList(e.current,e.size,e.keyword)},currentChange:function(e){var o=this;o.current=e,o.loading=!0,o.keyword?o.getList(e,o.size,o.keyword):o.getList(e,o.size)},sizeChange:function(e){var o=this;o.size=e,o.loading=!0,o.current=1,o.keyword?o.getList(1,e,o.keyword):o.getList(1,e)},addGoods:function(){var e=this;e.isAdd=!0,e.permissionData.includes("memberGoodsAdd")?e.dialogGood=!0:e.$message.warning("无权操作"),e.isDisabled=!1,e.isYes?e.goodsInfo={name:"",intro:"",detail:"",img:"",imgs:[],price:"",freight:"",on_shelf:1,is_fetch:1,have_merchant:[],sales:0,browse:0,sort:0,good_commissions:[{type:1,money:""},{type:2,money:""},{type:3,money:""}]}:e.goodsInfo={name:"",intro:"",detail:"",img:"",imgs:[],price:"",freight:"",on_shelf:1,is_fetch:1,sales:0,browse:0,sort:0,good_commissions:[{type:1,money:""},{type:2,money:""},{type:3,money:""}]},e.$refs.upload&&e.$refs.upload.clearFiles()},newMerchants:function(){var e=this;console.log(e.goodsInfo),e.goodsInfo.name&&e.goodsInfo.img&&e.goodsInfo.imgs&&e.goodsInfo.price&&e.goodsInfo.good_commissions?l["a"].createUserGoods(e.goodsInfo).then((function(o){1e4==o.code&&(e.$message.success("添加成功"),e.dialogGood=!1,e.dialogSel=!1,e.getList(e.current,e.size))})):e.$message.warning("请填写完整信息")},changeFetch:function(e){console.log(e),self.isYes=1==e},merchantChange:function(e){var o=this;o.goodsInfo.have_merchant=e},allSel:function(){var e=this,o=[];e.merchantList.forEach((function(e){o.push(e.id)})),e.goodsInfo.have_merchant=o},notifyChange:function(e,o,t){var s=this;console.log(t.id);var i=[];s.loading=!0,l["a"].userGoodDetail(t.id).then((function(o){o.result.have_merchant.forEach((function(e){i.push(e.id)})),1==e?(s.goodsInfo={name:o.result.name,intro:o.result.intro,detail:o.result.detail,img:o.result.img,imgs:o.result.imgs,price:o.result.price,freight:o.result.freight,on_shelf:o.result.on_shelf,is_fetch:1,have_merchant:i,id:o.result.id,sales:o.result.sales,browse:o.result.browse,sort:o.result.sort,good_commissions:[{type:1,money:o.result.good_commission[0].money,id:o.result.good_commission[0].id},{type:2,money:o.result.good_commission[1].money,id:o.result.good_commission[1].id},{type:3,money:o.result.good_commission[2].money,id:o.result.good_commission[2].id}]},s.dialogSel=!0):(s.goodsInfo={name:o.result.name,intro:o.result.intro,detail:o.result.detail,img:o.result.img,imgs:o.result.imgs,price:o.result.price,freight:o.result.freight,on_shelf:o.result.on_shelf,is_fetch:2,id:o.result.id,sales:o.result.sales,browse:o.result.browse,sort:o.result.sort,good_commissions:[{type:1,money:o.result.good_commission[0].money,id:o.result.good_commission[0].id},{type:2,money:o.result.good_commission[1].money,id:o.result.good_commission[1].id},{type:3,money:o.result.good_commission[2].money,id:o.result.good_commission[2].id}]},s.newMerchants())}))},handleDetail:function(e,o){var t=this;t.id=o.id;var s=[];t.isDisabled=!0,t.isAdd=!1,t.permissionData.includes("memberGoodsEdit")?(t.dialogGood=!0,l["a"].userGoodDetail(t.id).then((function(e){e.result.have_merchant.forEach((function(e){s.push(e.id)})),e.result.good_commission.length>0&&1==e.result.is_fetch?t.goodsInfo={name:e.result.name,intro:e.result.intro,detail:e.result.detail,img:e.result.img,imgs:e.result.imgs,price:e.result.price,freight:e.result.freight,on_shelf:e.result.on_shelf,is_fetch:e.result.is_fetch,have_merchant:s,id:e.result.id,sales:e.result.sales,browse:e.result.browse,sort:e.result.sort,good_commissions:[{type:1,money:e.result.good_commission[0].money,id:e.result.good_commission[0].id},{type:2,money:e.result.good_commission[1].money,id:e.result.good_commission[1].id},{type:3,money:e.result.good_commission[2].money,id:e.result.good_commission[2].id}]}:e.result.good_commission.length>0&&2==e.result.is_fetch&&(t.goodsInfo={name:e.result.name,intro:e.result.intro,detail:e.result.detail,img:e.result.img,imgs:e.result.imgs,price:e.result.price,freight:e.result.freight,on_shelf:e.result.on_shelf,is_fetch:e.result.is_fetch,id:e.result.id,sales:e.result.sales,browse:e.result.browse,sort:e.result.sort,good_commissions:[{type:1,money:e.result.good_commission[0].money,id:e.result.good_commission[0].id},{type:2,money:e.result.good_commission[1].money,id:e.result.good_commission[1].id},{type:3,money:e.result.good_commission[2].money,id:e.result.good_commission[2].id}]}),t.fileLists=t.goodsInfo.imgs.map((function(e){var o={};return o.url=e,o}));var o=t.goodsInfo.img.split(",");o.forEach((function(e){var o=new Object;o.url=e,t.files.push(o)}))}))):t.$message.warning("无权操作")},close:function(){var e=this;e.fileLists=[],e.files=[]},handleDelete:function(e,o){var t=this;t.permissionData.includes("memberGoodDel")?t.dialogDel=!0:t.$message.warning("无权操作"),t.id=o.id},toDel:function(){var e=this;l["a"].delUserGood(e.id).then((function(o){1e4==o.code&&(e.$message.success("删除成功"),e.dialogDel=!1,e.getList(e.current,e.size))})).catch((function(e){console.log(e)}))},beforeUpload:function(){s=this.$loading({lock:!0,text:"图片上传中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})},quillImgSuccess:function(e,o){var t=this.$refs.myQuillEditor.quill;if(s.close(),e.data){var i=t.getSelection().index;t.insertEmbed(i,"image",e.data),t.setSelection(i+1)}else this.$message.error("图片插入失败")},handleRemove:function(e,o){var t=this;t.files=o,t.goodsInfo.img=""},beforeAvatarUpload:function(e){var o=307200;return o||this.$message.error("上传图片大小不能超过300KB"),o},handleAvatarSuccess:function(e,o){var t=this;t.goodsInfo.img=o.response.data},handleExceed:function(e,o){var t=this;t.$message.error("上传图片不能超过1张!")},handleChange:function(e,o){var t=this;t.files=o},handleRemove1:function(e,o){var t=this;console.log(e),t.fileLists=o,t.goodsInfo.imgs.splice(t.goodsInfo.imgs.indexOf(e.url),1),t.hasNewImage1=!1},beforeAvatarUpload1:function(e){this.fileLists.length>9&&this.$message.error("最多只能上传9张图片");var o=e.size/1024<500;return o||this.$message.error("上传产品图片大小不能超过 500K!"),o&&this.fileLists.length<=9},handleAvatarSuccess1:function(e,o){console.log(e);var t=this;t.goodsInfo.imgs.push(o.response.data)},handleExceed1:function(e,o){var t=this;t.$message.error("上传图片不能超过9张!")},handleChange1:function(e,o){var t=this;t.fileLists=o}}}),c=r,d=(t("3fbf"),t("2877")),m=Object(d["a"])(c,i,n,!1,null,"c4a4cd3c",null);o["default"]=m.exports},b122:function(e,o,t){}}]);
//# sourceMappingURL=chunk-499ccd42.fe7c4c4a.js.map